#!/usr/bin/env bash

# BUG: THRE IS NO WAY TO SOURCE A FILE.
#      i3blocks does not even respect which environment
# that is running the script, always run with user default
# shell script.
# ANY VARS DECLARED IN ANOTHER SOURCE FILE WON'T WORK.
# . sys.conf

fa_window_maximize='\U000f2d0'

DEFAULT_FGCOLOR="#53ff1a"
DEF_ICON_COLOR="#0066ff"

no_quotes() {
        local str=$1

        echo "$(tr -d '\"'<<<$str)"
}

trunc() {
        local str=$@

		if [ "${#str}" -gt 50 ]; then
			echo -n "${str:0:47}..."
		else
			echo -n "$str"
		fi
}

INSTANCE_NAME=$(xprop -id `xprop -root _NET_ACTIVE_WINDOW | cut -d' ' -f5` WM_CLASS | cut -d ' ' -f4)
WIN_TITLE="$(no_quotes $INSTANCE_NAME)"

WIN_TITLE="${WIN_TITLE} - $(xdotool getactivewindow getwindowname)"
WIN_TITLE="$(trunc $WIN_TITLE)"

echo -e "<span foreground='#48c9b0' size='large'>$fa_window_maximize</span>"\
     "<span foreground='white' size='small'>$WIN_TITLE </span>"\
